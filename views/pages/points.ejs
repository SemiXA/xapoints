<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=devicewidth, initial-scale=1.0">
  <link rel="stylesheet" href="style/stylePointsWhitSending.css">
  <title>Mis puntos</title>
</head>

<body>
  <div id="menu">
    <div class="menuFoot">
      <a href="points"><img src="img/iconosMenu/mis-puntos-red.svg" alt="points"></a>
      <p class="red">Mis puntos</p>
    </div>
    <div class="menuFoot">
      <a href="ranking.html"><img src="img/iconosMenu/ranking-gray.svg" alt="ranking"></a>
      <p>Ranking</p>
    </div>
    <div class="menuFoot">
      <a href="#"><img src="img/iconosMenu/mi-perfil-gray.svg" alt="perfil"></a>
      <p>Mi perfil</p>
    </div>
    <div class="menuFoot">
      <a href="login.html"><img src="img/iconosMenu/logout-gray.svg" alt="exit"></a>
      <p>Salir</p>
    </div>
  </div>
  <div>
    <h1 class="center">MIS PUNTOS</h1>
    <hr />
    <div id="divPiechart">
      <div class="color">
        <div class="piechart1">
          <div id="numberpie1">
            <%= showPointsFromStudent.activa_points_balance %>
          </div>
        </div>
        <p class="pieText">DISPONIBLES<br> ¡Listos para enviar!</p>
      </div>
      <div>
        <div class="piechart2">
          <div id="numberpie2">
            <%= studentReceivedRewards.points %>
          </div>
        </div>
        <p class="pieText">TOTAL<br> <span id="sendText"> <a id="sentPoints" href="#">Enviados</a></span> | <span
            id="receibedText"> <a id="receivedPoints" href="#">Recibidos</a></span>
        </p>
      </div>
    </div>
  </div>
  <div id="enviarPuntos">
    <h2 class="center">ENVIAR PUNTOS</h2>
    <hr />
    <div id="fondo">
      <p class="center">Alumnos Xarxatec Activa 2023</p>
      <form action="/sendReward" method="post">
      <div class="search">

        <img id="iconActiva" src="img/puntos-activa-logo.svg" alt="logoBuscarGente">
        
          <select name="getStudents" id="alumnos">
            <% for(var i=0; i < getStudents.length; i++) { %>
              <option value='<%= getStudents[i].name %>' id="<%= getStudents[i].id %>">
                <%= getStudents[i].name %>
                  <%= getStudents[i].first_surname %>
              </option>
              <% } %>
          </select>
      </div>


      <div class="spanCenter">Descripción del envío</div>
      <div id="textContainerDescription">
        <input id="sendDescription" name="send" type="text">
      </div>
      <div class="spanCenter">¿cuánto envías?</div>
      <div id="numberContainerqty">
        <input id="pointQty" type="number">
        <input type="hidden" id="senderId" value="<%= studentId %>">
        <button type="submit" id="sendPoints">ENVIAR</button>
      </div>
      </form>
    </div>
  </div>
  <div id="miHistorial">
    <h2 class="center">MI HISTORIAL</h2>
    <hr />
    <div class="btnGroup">
      <button id="sendButton"><u>ENVIADOS</u></button>
      <a href="mispuntosRecibidos.html">
        <button id="receivedButton">RECIBIDOS</a></button>
    </div>
    <div class="pAlign">
      <div><span class="pointsRed"><b>
            <%= lastRewards[0].xp_points %>
          </b></span> PUNTOS ENVIADOS
        <%= lastRewards[0].date.getDate()%>/<%=lastRewards[0].date.getUTCMonth() +1%>/
            <%=lastRewards[0].date.getFullYear() %>
      </div>
      <p>
        <%= lastRewards[0].description %>
      </p>
      <p> de parte de <b>
          <%= lastRewards[0].name %>
        </b></p>
    </div>
    <hr id="hrHistory" />
    <div class="pAlign">
      <div><span class="pointsRed"><b>
            <%= lastRewards[1].xp_points %>
          </b></span> PUNTOS ENVIADOS
        <%= lastRewards[1].date.getDate()%>/<%=lastRewards[1].date.getUTCMonth() +1%>/
            <%=lastRewards[1].date.getFullYear() %>
      </div>
      <br>
      <%= lastRewards[1].description %><br>
        <p>de parte de <b>
            <%= lastRewards[1].name %>
          </b>
    </div>
    </p>
    <hr id="hrHistory" />
    <div class="pAlign">
      <div><span class="pointsRed"><b>
            <%= lastRewards[2].xp_points %>
          </b></span> PUNTOS ENVIADOS
        <%= lastRewards[2].date.getDate()%>/<%=lastRewards[2].date.getUTCMonth()+1%>/
            <%=lastRewards[2].date.getFullYear() %>
      </div>
      <br>
      <%= lastRewards[2].description %><br>
        <p> de parte de <b>
            <%= lastRewards[2].name %>
          </b>
    </div>
    </p>
    <hr id="hrHistory" />
    <div class="pAlign">
      <div><span class="pointsRed"><b>
            <%= lastRewards[3].xp_points %>
          </b></span> PUNTOS ENVIADOS
        <%= lastRewards[3].date.getDate()%>/<%=lastRewards[3].date.getUTCMonth()+1%>/
            <%=lastRewards[3].date.getFullYear() %>
      </div>
      <br>
      <%= lastRewards[3].description %><br>
        <p> de parte de <b>
            <%= lastRewards[3].name %>
          </b>
    </div>
    </p>
    <hr id="hrHistory" />
    <div class="pAlign">
      <div><span class="pointsRed"><b>
            <%= lastRewards[4].xp_points %>
          </b></span> PUNTOS ENVIADOS
        <%= lastRewards[4].date.getDate()%>/<%=lastRewards[4].date.getUTCMonth()+1%>/
            <%=lastRewards[4].date.getFullYear() %>
      </div>
      <br>
      <%= lastRewards[4].description %><br>
        <p> de parte de <b>
            <%= lastRewards[4].name %>
          </b>
    </div>
    </p>
    <br><br><br><br>
  </div>
  <script>
    const numpie = document.getElementById("numberpie2");
    const receivedPoints = document.getElementById("receivedPoints");
    const sentPoints = document.getElementById("sentPoints");


    function receivedSentRewards(e) {
      if (e.target.innerText == "Recibidos") numpie.innerHTML = `<%= studentReceivedRewards.points %>`;
      if (e.target.innerText == "Enviados") numpie.innerHTML = `<%= studentSentRewards.points %>`;
    }

    receivedPoints.addEventListener("click", receivedSentRewards);
    sentPoints.addEventListener("click", receivedSentRewards);
  </script>

</body>

</html>